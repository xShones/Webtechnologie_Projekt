<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Transaktionen</title>
  <script defer src="/auth.js"></script>
</head>
<body>
<h2>Liste der Transaktionen</h2>
<button id="fetchTransactionsBtn">Transaktionen abrufen</button>
<div id="transactionsContainer"></div>
<noscript>
  Bitte aktivieren Sie JavaScript, um die Transaktionen zu laden.
</noscript>
<script>
  async function displayTransactions() {
    const response = await authFetch('/transactions/all', { method: 'GET' });
    if (response.ok) {
      try {
        const data = await response.json();
        const container = document.getElementById('transactionsContainer');
        container.innerHTML = '<table><tr><th>ID</th><th>Betrag</th><th>Datum</th></tr>' +
                data.map(transaction => `<tr><td>${transaction.id}</td><td>${transaction.amount}</td><td>${transaction.date}</td></tr>`).join('') +
                '</table>';
      } catch (error) {
        alert('Fehler beim Verarbeiten der Serverantwort.');
        console.error('JSON Parsing Error:', error);
      }
    } else {
      alert('Fehler beim Abrufen der Transaktionen.');
      console.error('Serverfehler:', response.status, response.statusText);
    }
  }

  // Event-Listener f√ºr den Button
  document.getElementById('fetchTransactionsBtn').addEventListener('click', displayTransactions);

  // Daten automatisch beim Laden der Seite abrufen
  window.onload = displayTransactions;
</script>
</body>
</html>